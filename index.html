<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Matrix — We are Anonymous</title>
<style>
  :root { --code:#00ff55; --bg:#000; }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%;background:var(--bg);font-family:ui-monospace,monospace;overflow:hidden}
  canvas{display:block;position:fixed;inset:0;z-index:0}

  /* center text */
  .center {
    position:fixed; left:50%; top:50%; transform:translate(-50%,-50%);
    z-index:30; pointer-events:none; text-align:center;
  }
  .mainLine {
    color:var(--code);
    font-size:clamp(20px,6vw,72px);
    letter-spacing:2px;
    text-shadow: 0 0 26px rgba(0,255,120,0.12), 0 0 6px rgba(0,255,120,0.25);
    user-select:none;
    display:block;
    mix-blend-mode:screen;
  }
  .sub {
    margin-top:10px;
    color: rgba(170,255,190,0.9);
    font-size:clamp(12px,2vw,18px);
  }

  /* glitch effect (simple) */
  .glitch { position:relative; display:inline-block; }
  .glitch::before, .glitch::after {
    content: attr(data-text);
    position:absolute; left:0; top:0; width:100%;
    clip: rect(0, 9999px, 0, 0); pointer-events:none;
  }
  .glitch.glitching::before { animation: g1 1.6s infinite linear; color: rgba(0,255,120,0.85); transform: translate(-3px,-1px); mix-blend-mode:screen; }
  .glitch.glitching::after  { animation: g2 2.2s infinite linear; color: rgba(60,255,160,0.6); transform: translate(2px,1px); mix-blend-mode:screen; }
  @keyframes g1 {
    0%{clip:rect(0,9999px,0,0)}
    6%{clip:rect(8px,9999px,48px,0)}
    12%{clip:rect(0,9999px,0,0); transform:translate(-6px,-2px)}
    30%{clip:rect(18px,9999px,80px,0)}
    100%{clip:rect(0,9999px,0,0)}
  }
  @keyframes g2 {
    0%{clip:rect(0,9999px,0,0)}
    8%{clip:rect(40px,9999px,120px,0)}
    18%{clip:rect(0,9999px,0,0); transform:translate(6px,3px)}
    50%{clip:rect(10px,9999px,60px,0)}
    100%{clip:rect(0,9999px,0,0)}
  }

  /* Flags overlay */
  .flag-overlay {
    position:fixed; inset:0; z-index:50; display:flex; align-items:center; justify-content:center;
    pointer-events:none; opacity:0; transition:opacity 240ms ease;
  }
  .flag-overlay.visible { opacity:1; pointer-events:auto; }

  .flag-box {
    width:min(64vmin,520px); aspect-ratio:3/2; border-radius:8px; overflow:hidden;
    box-shadow: 0 12px 40px rgba(0,0,0,0.7);
    transform:scale(0.98); transition:transform 240ms cubic-bezier(.2,.9,.2,1);
  }
  .flag-overlay.visible .flag-box { transform:scale(1); }

  .pal .stripes { width:100%; height:100%; background:linear-gradient(#000 0 33.333%, #fff 33.333% 66.666%, #007a3d 66.666% 100%); position:relative; }
  .pal .triangle { position:absolute; left:0; top:0; bottom:0; width:45%; clip-path:polygon(0 50%,45% 0,45% 100%); background:#ce1126; }

  .egy .stripes { width:100%; height:100%; background:linear-gradient(#ce1126 0 33.333%, #fff 33.333% 66.666%, #000 66.666% 100%); position:relative; }
  .egy .egy-emblem { position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); font-size:44px; color:#b38a00; text-shadow:0 2px 6px rgba(0,0,0,0.6); }

  /* hint text */
  .hint { position:fixed; left:12px; bottom:12px; z-index:40; color:rgba(255,255,255,0.65); background:rgba(0,0,0,0.18); padding:8px 10px; border-radius:8px; font-size:13px }
  @media (max-width:480px){ .mainLine{font-size:clamp(18px,9vw,48px)} }
</style>
</head>
<body>
<canvas id="c"></canvas>

<div class="center">
  <div id="mainLine" class="mainLine glitch" data-text="We are Anonymous">We are Anonymous</div>
  <div id="sub" class="sub">Welcome to Hell (will appear next)</div>
</div>

<div class="hint">P = Palestine (7s) · E = Egypt (7s)</div>

<!-- Flags -->
<div id="flagPal" class="flag-overlay" aria-hidden="true">
  <div class="flag-box pal" role="img" aria-label="Palestinian flag"><div class="stripes"></div><div class="triangle"></div></div>
</div>

<div id="flagEgy" class="flag-overlay" aria-hidden="true">
  <div class="flag-box egy" role="img" aria-label="Egypt flag"><div class="stripes"></div><div class="egy-emblem">𓂀</div></div>
</div>

<script>
(() => {
  // Canvas setup
  const canvas = document.getElementById('c');
  const ctx = canvas.getContext('2d');
  function resize(){ canvas.width = innerWidth; canvas.height = innerHeight; initCols(); }
  addEventListener('resize', resize);
  resize();

  // Letters (mix arabic + english)
  const letters = ("ابتثجحخدذرزسشصضطظعغفقكلمنهويىء" + "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%&*").split('');
  let fontSize = Math.max(10, Math.floor(innerWidth / 90));
  let cols = Math.floor(innerWidth / fontSize);
  let drops = [];

  function initCols(){
    fontSize = Math.max(9, Math.floor(innerWidth / 90));
    cols = Math.max(20, Math.floor(innerWidth / fontSize));
    drops = new Array(cols).fill().map(i => ({ x: i*fontSize, y: Math.random()*-1000, speed: 1+Math.random()*2.2, len: 8+Math.floor(Math.random()*22) }));
  }

  // Matrix draw loop
  let codeColor = getComputedStyle(document.documentElement).getPropertyValue('--code').trim() || '#00ff55';
  let speedFactor = 2.8;

  function rgba(hex, a=1){
    const c = hex.replace('#','');
    const r = parseInt(c.substring(0,2),16);
    const g = parseInt(c.substring(2,4),16);
    const b = parseInt(c.substring(4,6),16);
    return `rgba(${r},${g},${b},${a})`;
  }

  function draw(){
    const w = canvas.width, h = canvas.height;
    // trail
    ctx.fillStyle = `rgba(0,0,0,0.06)`;
    ctx.fillRect(0,0,w,h);
    ctx.font = `${fontSize}px monospace`;
    ctx.textBaseline = 'top';

    for(let i=0;i<drops.length;i++){
      const d = drops[i];
      const lead = Math.random() > 0.98;
      const chars = Math.min(6, d.len);
      for(let t=0;t<chars;t++){
        const ch = letters[Math.floor(Math.random()*letters.length)];
        const y = Math.floor(d.y - t * fontSize * 0.9);
        const alpha = lead ? Math.max(0.18, 0.95 - t*0.12) : Math.max(0.06, 0.55 - t*0.08);
        ctx.fillStyle = rgba(codeColor, alpha);
        ctx.fillText(ch, d.x, y);
      }
      d.y += d.speed * speedFactor * (0.75 + Math.sin(d.y*0.01)*0.12);
      if(d.y - d.len*fontSize > h && Math.random() > 0.96){
        d.y = -Math.random()*400;
        d.speed = 0.6 + Math.random()*2.8;
      }
    }
    requestAnimationFrame(draw);
  }
  requestAnimationFrame(draw);

  // Quotes handling
  const mainLine = document.getElementById('mainLine');
  const sub = document.getElementById('sub');
  const quotes = ["We are Anonymous", "Welcome to Hell"];
  let qIdx = 0;
  let quoteInterval = null;
  let pausedByFlag = false;

  function setMainText(t){
    mainLine.setAttribute('data-text', t);
    // glitch blink
    mainLine.classList.add('glitching');
    setTimeout(()=> mainLine.classList.remove('glitching'), 900);
    mainLine.textContent = t;
  }

  function startQuotes(){
    // start with first immediately
    qIdx = 0;
    setMainText(quotes[0]);
    sub.textContent = '';
    // after 2s show second
    setTimeout(()=> {
      if(!pausedByFlag){ qIdx = 1; setMainText(quotes[1]); sub.textContent = ''; }
    }, 2000);
    // then continue rotating every 7s
    clearInterval(quoteInterval);
    quoteInterval = setInterval(()=> {
      if(!pausedByFlag){
        qIdx = (qIdx + 1) % quotes.length;
        setMainText(quotes[qIdx]);
      }
    }, 7000);
  }

  function stopQuotes(){ clearInterval(quoteInterval); }

  startQuotes();

  // Flags logic
  const flagPal = document.getElementById('flagPal');
  const flagEgy = document.getElementById('flagEgy');
  let timers = { pal: null, egy: null };

  function showFlag(which){
    // pause quotes
    pausedByFlag = true;
    stopQuotes();

    const el = which === 'pal' ? flagPal : flagEgy;
    el.classList.add('visible');
    el.setAttribute('aria-hidden','false');

    // clear existing timer if any
    if(timers[which]) clearTimeout(timers[which]);

    // hide after 7s and resume quotes
    timers[which] = setTimeout(()=> {
      el.classList.remove('visible');
      el.setAttribute('aria-hidden','true');
      timers[which] = null;
      pausedByFlag = false;
      startQuotes();
    }, 7000);
  }

  // key handlers
  document.addEventListener('keydown', (e) => {
    const k = e.key.toLowerCase();
    if(k === 'p'){ showFlag('pal'); }
    if(k === 'e'){ showFlag('egy'); }
    // optional: speed control
    if(k === 'arrowup'){ speedFactor = Math.min(8, speedFactor + 0.4); }
    if(k === 'arrowdown'){ speedFactor = Math.max(0.6, speedFactor - 0.4); }
  });

  // clicking flag overlay hides it early
  [flagPal, flagEgy].forEach(f => f.addEventListener('click', ()=> {
    f.classList.remove('visible');
    f.setAttribute('aria-hidden','true');
    // clear timers and resume
    if(timers.pal){ clearTimeout(timers.pal); timers.pal = null; }
    if(timers.egy){ clearTimeout(timers.egy); timers.egy = null; }
    pausedByFlag = false;
    startQuotes();
  }));

})();
</script>
</body>
</html>
